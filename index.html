<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@300..700&amp;display=swap" rel="stylesheet">

    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:ital,wght@0,100..700;1,100..700&display=swap"
        rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100..700;1,100..700&display=swap"
        rel="stylesheet">
    <link
        href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400..900&amp;family=Montserrat:ital,wght@0,100..900;1,100..900&amp;display=swap"
        rel="stylesheet">
    <link rel="profile" href="https://gmpg.org/xfn/11">
    <link rel="apple-touch-icon" sizes="180x180"
        href="https://selsky-dvur.info/wp-content/themes/selsky-dvur-2024/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32"
        href="https://selsky-dvur.info/wp-content/themes/selsky-dvur-2024/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16"
        href="https://selsky-dvur.info/wp-content/themes/selsky-dvur-2024/favicon-16x16.png">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
        <title>Kalkulátor</title>
    <style>
        body,
        button,
        input,
        select,
        optgroup,
        textarea {
            color: #404040;
            font-family: "Roboto";
            font-size: 1.2rem;
            line-height: 1.5;
        }

        input {
            font-family: "Roboto Mono", monospace;
        }

        a,
        a:focus {
            color: #000;
        }

        span.holiday-info {
            border: 1px solid #18729c;
            width: 25px;
            height: 25px;
            color: white;
            background: #18729c;
            display: inline-block;
            text-align: center;
            border-radius: 100%;
            font-size: 16px;
            position: absolute;
            left: 0px;
            cursor: pointer;
        }

        tr td {
            position: relative;
        }

        .container {
            max-width: 1600px;
        }

        div#apartmentTabsContent {}

        .nav-tabs .nav-item.show .nav-link,
        .nav-tabs .nav-link.active {}

        h1 {
            text-align: center;
        }

        .form-group-inline {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
        }

        .form-group {
            flex: 1;
            margin-right: 10px;
            margin-bottom: 15px;
        }

        .form-group:last-child {
            margin-right: 0;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            box-sizing: border-box;
            color: #333;
        }

        .form-group label {
            font-weight: bold;
            color: black;
            width: 100%;
        }

        .btn-primary {
            width: 100%;
            margin-top: 10px;
        }

        .result {
            display: none;
        }

        .breakdown {
            margin-top: 10px;
            background-color: #e9ecef;
            padding: 10px;
            border-radius: 10px;
        }

        .breakdown table {
            width: 100%;
            border-collapse: collapse;
        }

        .breakdown th,
        .breakdown td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }

        .breakdown th {
            background-color: #f2f2f2;
        }

        .summary {
            margin-top: 20px;
        }

        .navbar-brand {
            margin: 0px auto;
            width: 100%;
            text-align: center;
        }

        .table td,
        .table th {
            padding: 0px;
            vertical-align: top;
            border-top: 1px solid #dee2e6;
            padding-top: 4px;
            padding-bottom: 4px;
            padding-right: 4px;
        }

        .table td,
        .table th {
            text-align: right;
        }

        .text-bold {
            font-weight: bold;
        }

        .text-bold td,
        .text-bold th {}

        h3 {
            margin-bottom: 1rem;
        }

        .reservationDiv {
            display: none;
        }

        .reservationDiv.visible {
            display: block;
        }

        #reservationForm {}

        .celkova td {
            background: #eee;
        }
  
        body {
            background-color: #f7f9fc;
         }
       
    </style>
</head>

<body>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>

    <div class="container pt-2"> 
        <div class="accordion" id="accordionExample">
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                    <span class="material-symbols-outlined pe-1">
                        hotel
                        </span> Termín ubytování
                </button>
              </h2>
              <div id="collapseOne" class="accordion-collapse collapse show" data-bs-parent="#accordionExample">
                <div class="accordion-body">
                  
                    <form id="priceCalculatorA">
                        <div class="form-group-inline p-2">
                            <div class="form-group">
                                <label for="daterange">Termín</label>
                                <input class="form-control mb-2"  type="text" id="daterange" name="daterange" value="18.07.2024 - 24.07.2024" />
                                <label for="nights">Počet nocí</label>
                                <input class="form-control" type="number" id="nights" readonly disabled>
                            </div>
                            
                            <div class="form-group">
                                <label for="peopleA">Dospělých osob</label>
                                <select class="form-control mb-2" id="peopleA" name="peopleA" required onchange="updateRemainingBeds()">
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                    <option value="11">11</option>
                                </select>
                                <label for="remainingBeds">Neobsazených postelí</label>
                                <input class="form-control" type="number" id="remainingBeds" readonly disabled>
                            </div>
                            <div class="form-group">
                                <label for="petsA">Mazlíčků</label>
                                <select class="form-control" id="petsA" name="petsA" required>
                                    <option value="0">0</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                </select>
                            </div>
                            
                        </div>
                             <button type="submit" class="btn btn-primary h-100">Spočítej</button>
                     </form>

                </div>
              </div>
            </div>
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button collapsed collapseTwo" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                    <span class="material-symbols-outlined pe-1">
                        calculate
                        </span> Kalkulace ubytování
                </button>
              </h2>
              <div id="collapseTwo" class="accordion-collapse collapse" data-bs-parent="#accordionExample">
                <div class="accordion-body">
                  
                    <div>
                        <div id="result" class="result mb-3"></div>
                        <div id="recap" class="mb-3"> </div>
                    </div> 

                </div>
              </div>
            </div>
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button collapsed collapseThree" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                    <span class="material-symbols-outlined pe-1">
                        send
                        </span> Poptávka ubytování
                </button>
              </h2>
              <div id="collapseThree" class="accordion-collapse collapse" data-bs-parent="#accordionExample">
                <div class="accordion-body">
                 
                    <div class="reservationDiv mb-3">
                        <form id="reservationForm">
                         <div class="form-group-inline p-2">

                            <div class="form-group">
                                <label for="firstName">Jméno</label>
                                <input type="text" class="form-control" id="firstName" name="firstName" required>
                            </div>
                            <div class="form-group">
                                <label for="lastName">Příjmení</label>
                                <input type="text" class="form-control" id="lastName" name="lastName" required>
                            </div>
                            <div class="form-group">
                                <label for="contact">Telefon</label>
                                <input type="text" class="form-control" id="contact" name="contact" required>
                            </div>
                            <div class="form-group">
                                <label for="mail">Email</label>
                                <input type="mail" class="form-control" id="mail" name="mail" required>
                            </div>
                            
                           
                        </div> <div class="form-group-inline p-2">
                            <div class="form-group">
                                <label for="note">Poznámka</label>
                               <textarea class="form-control" id="note" name="note" rows="4" required></textarea>
                              </div>
      

                        </div>
                  
                        <button type="submit" class="btn btn-danger">Odeslat</button>
                        </form>
                    </div>

                </div>
              </div>
            </div>
          </div>
        <div>
          
        </div>
        

        
 
        
    </div>

    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script> 
    <script type="text/javascript" src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" />

    <script>
        $(function() {
            // Calculate default start and end dates
            const today = new Date();
            const defaultStartDate = new Date(today);
            defaultStartDate.setDate(defaultStartDate.getDate() + 1);
            const defaultEndDate = new Date(defaultStartDate);
            defaultEndDate.setDate(defaultEndDate.getDate() + 3);
        
            // Format dates as DD.MM.YYYY
            const formatDate = (date) => {
                const day = String(date.getDate()).padStart(2, '0');
                const month = String(date.getMonth() + 1).padStart(2, '0');
                const year = date.getFullYear();
                return `${day}.${month}.${year}`;
            };
        
            const defaultStart = formatDate(defaultStartDate);
            const defaultEnd = formatDate(defaultEndDate);
        
            // Initialize the date range picker
            $('#daterange').daterangepicker({
                "showDropdowns": false,
                "autoApply": false,
                "locale": {
                    "format": "DD.MM.YYYY",
                    "separator": " - ",
                    "applyLabel": "Aplikovat",
                    "cancelLabel": "Zrušit",
                    "fromLabel": "Příjezd",
                    "toLabel": "Odjezd",
                    "customRangeLabel": "Vlastní",
                    "weekLabel": "T",
                    "daysOfWeek": [
                        "Ne", "Po", "Út", "St", "Čt", "Pá", "So"
                    ],
                    "monthNames": [
                        "Leden", "Únor", "Březen", "Duben", "Květen", "Červen", "Červenec", "Srpen", "Září", "Říjen", "Listopad", "Prosinec"
                    ],
                    "firstDay": 1
                },
                "linkedCalendars": true,
                "showCustomRangeLabel": false,
                "startDate": defaultStart,
                "endDate": defaultEnd,
                "drops": "down"
            }, function(start, end, label) {
                const nights = end.diff(start, 'days');
                $('#nights').val(nights);
            });
        
            // Calculate nights on first load
            const initialNights = defaultEndDate.getDate() - defaultStartDate.getDate();
            $('#nights').val(initialNights);
        });
        
        const holidays = [
            { date: "01-01", title: "Den obnovy samostatného českého státu" },
            { date: "05-08", title: "Den vítězství" },
            { date: "07-05", title: "Den slovanských věrozvěstů Cyrila a Metoděje" },
            { date: "07-06", title: "Den upálení mistra Jana Husa" },
            { date: "09-28", title: "Den české státnosti" },
            { date: "10-28", title: "Den vzniku samostatného československého státu" },
            { date: "11-17", title: "Den boje za svobodu a demokracii" },
            { date: "01-01", title: "Nový rok" },
            { date: "04-04", title: "Velký pátek" }, // Example date for Velký pátek (Good Friday)
            { date: "04-05", title: "Velikonoční pondělí" }, // Example date for Velikonoční pondělí (Easter Monday)
            { date: "05-01", title: "Svátek práce" },
            { date: "12-24", title: "Štědrý den" },
            { date: "12-25", title: "1. svátek vánoční" },
            { date: "12-26", title: "2. svátek vánoční" },
            { date: "12-31", title: "Silvestr" } // Adding New Year's Eve as a holiday

        ];

        function formatPrice(price) {
            return price.toString().replace(/\B(?=(\d{3})+(?!\d))/g, " ");
        }
        function formatDate(date) {
            const day = String(date.getDate()).padStart(2, '0');
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const year = date.getFullYear();
            return `${day}.${month}.${year}`;
        }

        function isHoliday(date) {
            const formattedDate = date.toISOString().slice(5, 10); // format as MM-DD
            return holidays.includes(formattedDate);
        }

        function isWeekend(date) {
            const day = date.getDay();
            return day === 5 || day === 6;
        }
  
        function containsNewYear(dateFrom, dateTo) {
            const newYearEve = new Date(dateFrom.getFullYear(), 11, 31); // 31. prosinec daného roku
            const newYearDay = new Date(dateFrom.getFullYear() + 1, 0, 1); // 1. leden následujícího roku
            return (dateFrom <= newYearEve && dateTo >= newYearEve) || (dateFrom <= newYearDay && dateTo >= newYearDay);
        }
        
        
        function calculatePrice(formId, resultId, apartment) {
            const dateRange = $('#daterange').val().split(' - ');
            const dateFrom = new Date(dateRange[0].split('.').reverse().join('-'));
            const dateTo = new Date(dateRange[1].split('.').reverse().join('-'));
            let people = parseInt(document.getElementById(`people${apartment}`).value, 10);
            const pets = parseInt(document.getElementById(`pets${apartment}`).value, 10);

            const diffTime = Math.abs(dateTo - dateFrom);
            const diffNights = Math.ceil(diffTime / (1000 * 60 * 60 * 24));

            if ((dateTo - dateFrom) <= 0) {
                alert('Datum odjezdu je menší nebo rovno datu příjezdu, nelze spočítat. Počet nocí musí být kladný.');
                return;
            }
            if (diffNights < 1) {
                alert('Minimální počet nocí ubytování je 1.');
                return;
            }

            let capacity, standardPrice, weekendPrice, unusedBedPrice, holidayPrice, silvestrPrice;
            if (apartment === 'A') {
                capacity = 11;
                standardPrice = 500;
                weekendPrice = 600;
                unusedBedPrice = 200;
                holidayPrice = 600;
                silvestrPrice = 650;
            } else {
                capacity = 6;
                standardPrice = 500;
                weekendPrice = 600;
                unusedBedPrice = 200;
                holidayPrice = 600;
                silvestrPrice = 650;
            }

            let totalPrice = 0;
            let priplatekth = '';
            let priplatektd = '';

            if (diffNights === 1) {
                priplatektd = '<td></td>';
                priplatekth = '<th>Příplatek 30%</th>';
            }

            let breakdown = `<table class="table">
            <tr class="text-bold"><th>Noc</th><th>Cena</th><th>Dospělých osob</th><th>Neobsazených postelí</th><th>Poplatek za mazlíčka</th>${priplatekth}<th>Cena</th></tr>`;

            for (let day = new Date(dateFrom); day < dateTo; day.setDate(day.getDate() + 1)) {
                let dayPrice = 0;
                let dateString = formatDate(day);
                let occupiedBedsPrice = 0;
                let unoccupiedBedsPrice = 0;
                let petCharge = 0;
                let priceType = '';
                let holidayTitle = '';
                const holiday = holidays.find(holiday => holiday.date === `${String(day.getMonth() + 1).padStart(2, '0')}-${String(day.getDate()).padStart(2, '0')}`);

                if (containsNewYear(dateFrom, dateTo) && diffNights < 4) {
                    alert('Minimální počet nocí ubytování přes Silvestr je 4.');
                    return;
                }
                else if (containsNewYear(dateFrom, dateTo) && 
                (day >= new Date(dateFrom.getFullYear(), 11, 30) && day <= new Date(dateFrom.getFullYear() + 1, 0, 3))) {
                
                people = 10;
                document.getElementById(`people${apartment}`).value = 10;
                priceType = 'Silvestr';
                occupiedBedsPrice = silvestrPrice * people;
                occupiedBedsPriceTitle = people + ' x ' + silvestrPrice + ' = ' + formatPrice(occupiedBedsPrice) + ' CZK';
            }
            
            
                
                else if (holiday) {
                    priceType = 'Sváteční';
                    holidayTitle = holiday.title;
                    occupiedBedsPrice = holidayPrice * people;
                    occupiedBedsPriceTitle = people + ' x ' + holidayPrice + ' = ' + formatPrice(occupiedBedsPrice) + ' CZK';
                } else if (isWeekend(day)) {
                    priceType = 'Víkendová';
                    occupiedBedsPrice = weekendPrice * people;
                    occupiedBedsPriceTitle = people + ' x ' + weekendPrice + ' = ' + formatPrice(occupiedBedsPrice) + ' CZK';
                } else {
                    priceType = 'Normální';
                    occupiedBedsPrice = standardPrice * people;
                    occupiedBedsPriceTitle = people + ' x ' + standardPrice + ' = ' + formatPrice(occupiedBedsPrice) + ' CZK';
                }

                unoccupiedBedsPrice = unusedBedPrice * (capacity - people);
                unoccupiedBedsPriceTitle = (capacity - people) + ' x ' + unusedBedPrice + ' = ' + formatPrice(unoccupiedBedsPrice) + ' CZK';

                if (pets > 0) {
                    petCharge = pets * 200;
                }

                dayPrice = occupiedBedsPrice + unoccupiedBedsPrice + petCharge;

                if (diffNights === 1) {
                    const surcharge = dayPrice * 0.3;
                    dayPrice += surcharge;
                    breakdown += `<tr>
                        <td title=" ${day.toLocaleDateString('cs-CZ', { weekday: 'long' })}"><span class="holiday-info" title="${holidayTitle} | 30% příplatek za 1 den">i</span>${dateString}</td>
                        <td>${priceType}</td>
                        <td>${occupiedBedsPriceTitle}</td>
                        <td>${unoccupiedBedsPriceTitle}</td>
                        <td>${formatPrice(petCharge)} CZK</td>
                        <td>${formatPrice(surcharge)} CZK</td>
                        <td>${formatPrice(dayPrice)} CZK</td>
                    </tr>`;
                } else {
                    breakdown += `<tr>
                        <td title=" ${day.toLocaleDateString('cs-CZ', { weekday: 'long' })}">${holiday ? `<span class="holiday-info" title="${holidayTitle}">i</span>` : ''} ${dateString}</td>
                        <td>${priceType}</td>
                        <td>${occupiedBedsPriceTitle}</td>
                        <td>${unoccupiedBedsPriceTitle}</td>
                        <td>${formatPrice(petCharge)} CZK</td>
                        <td>${formatPrice(dayPrice)} CZK</td>
                    </tr>`;
                }

                totalPrice += dayPrice;
            }

            breakdown += `<tr class="text-bold celkova bg-secondary">
                <td></td>
                <td>Celková cena</td>
                <td></td>
                <td></td>
                <td></td>
                ${priplatektd}
                <td>${formatPrice(totalPrice)} CZK</td>
            </tr></table>`;

            const summary = `<table class="table">
                <thead>
                    <tr class="text-bold"><th>Příjezd</th><th>Odjezd</th><th>Nocí</th><th>Dospělých osob</th><th>Neobsazených postelí</th><th>Mazlíčků</th></thead>
                </tr>
                <tr>
                    <td>${formatDate(dateFrom)}</td>
                    <td>${formatDate(dateTo)}</td>
                    <td>${diffNights}</td>
                    <td>${people}</td>
                    <td>${capacity - people}</td>
                    <td>${pets}</td>
                </tr>
            </table>`;

            document.getElementById(resultId).innerHTML = breakdown;
            document.getElementById(resultId).style.display = 'block';

            document.querySelector('.reservationDiv').classList.toggle("visible");
           
        }
        document.addEventListener('DOMContentLoaded', function() {
            const form = document.querySelector('#priceCalculatorA');
            const kalkulaceSection = document.querySelector('#collapseTwo');
            const kalkulaceButton = document.querySelector('.collapseTwo');

            const rezervaceSection = document.querySelector('#collapseThree');
            const rezervaceButton = document.querySelector('.collapseThree');

            // Initially hide the additional sections using d-none class
            kalkulaceSection.classList.add('d-none');
            rezervaceSection.classList.add('d-none');
            kalkulaceButton.classList.add('d-none');
            rezervaceButton.classList.add('d-none');
            form.addEventListener('submit', function(event) {
                event.preventDefault(); // Prevent the default form submission
        
                // Perform form validation and calculations here if needed
                document.getElementById('result').style.display = 'none';
                setTimeout(() => {
                    calculatePrice('priceCalculatorA', 'result', 'A');
                
                    // Show the "Kalkulace" section
                    kalkulaceSection.classList.remove('d-none');
                    kalkulaceButton.classList.remove('d-none');

                    new bootstrap.Collapse(kalkulaceSection, {
                        toggle: true
                    });
        
                    // Show the "Rezervace" section
                    rezervaceSection.classList.remove('d-none');
                    rezervaceButton.classList.remove('d-none');

                    new bootstrap.Collapse(rezervaceSection, {
                        toggle: true
                    });
                }, 500);
            });
        });
        
        

        function updateRemainingBeds() {
            const totalBeds = 11;
            const selectedPeople = document.getElementById("peopleA").value;
            const remainingBeds = totalBeds - selectedPeople;
            document.getElementById("remainingBeds").value = remainingBeds;
        }
 
        document.getElementById('reservationForm').addEventListener('submit', function(event) {
            event.preventDefault(); // Prevent the form from submitting normally
        
            const contact = document.getElementById('contact').value;
            const dateRange = $('#daterange').val().split(' - ');

            const dateFrom = new Date(dateRange[0].split('.').reverse().join('-'));
            const dateTo = new Date(dateRange[1].split('.').reverse().join('-'));
            
            const diffTime = Math.abs(dateTo - dateFrom);
            const diffNights = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            const totalPrice ="5";
            let people = parseInt(document.getElementById(`peopleA`).value, 10);
            const pets = parseInt(document.getElementById(`petsA`).value, 10);
            const note = document.getElementById(`note`).value;
            const mail = document.getElementById(`mail`).value;

             const firstName = document.getElementById('firstName').value;
            const lastName = document.getElementById('lastName').value;
  

            alert(`Jméno: ${firstName}\nPříjmení: ${lastName}\nEmail: ${mail}\nTelefon: ${contact}\nPříjezd: ${formatDate(dateFrom)}\nOdjezd: ${formatDate(dateTo)}\nPočet nocí: ${diffNights}\nOsob: ${people}\nMazlíčků: ${pets}\nPoznámka: ${note}`);
 
        
            // Optionally, you can submit the form here if needed
            // this.submit();
        });
        function isWeekend(date) {
            const day = date.getDay();
            return day === 5 || day === 6;
        }
        window.onload = function() {
            updateRemainingBeds();
        };
        
    </script>
</body>

</html>
